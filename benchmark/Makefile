# ==================================================================================== #
# = Executable
# ==================================================================================== #

BIN = benchmark

# ==================================================================================== #
# = Compiler settings
# ==================================================================================== #

CC      = g++
CPPFLAGS += -O3 -fno-tree-vectorize -std=c++11
LIBS   += -lm -lcriterion

# ==================================================================================== #
# = Object / Assembly Files
# ==================================================================================== #

%.o : %.c
	$(CC) $(CPPFLAGS) -c $< -o $@

%.s : %.c
	$(CC) $(CPPFLAGS) -S $< -o $@

%.o : %.cpp
	$(CC) $(CPPFLAGS) -c $< -o $@

%.s : %.cpp
	$(CC) $(CPPFLAGS) -S $< -o $@

C_SRCS=$(wildcard *.c \
../penguin/main.c \
../HGWOSCA/main.c \
../objectives/objectives.c \
)

CPP_SRCS=$(wildcard *.cpp)

OBJS=$(C_SRCS:.c=.o) $(CPP_SRCS:.cpp=.o)

ASMS=$(C_SRCS:.c=.s) $(CPP_SRCS:.cpp=.s)


# ==================================================================================== #
# = Targets
# ==================================================================================== #

all: $(OBJS) $(ASMS)
	$(CC) $(OBJS) -o $(BIN) $(LIBS)

clean:
	rm -rf *.txt $(OBJS) $(ASMS)
	rm -rf $(BIN)
